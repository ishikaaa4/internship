#include <SPI.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#include <ams_as5048b.h>

#define SCREEN_WIDTH 128 // OLED display width, in pixels
#define SCREEN_HEIGHT 32 // OLED display height, in pixels
#define OLED_RESET     -1 // Reset pin # (or -1 if sharing Arduino reset pin)
#define SCREEN_ADDRESS 0x3C ///< See datasheet for Address; 0x3D for 128x64, 0x3C for 128x32
Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, OLED_RESET);

#define NUMFLAKES     10 // Number of snowflakes in the animation example

AMS_AS5048B mysensor;

void homepage(int x);
void page1();
void page2();

void setup() 
{
   
  Serial.begin(9600);
	while (!Serial) ; 
	mysensor.begin();
	mysensor.setClockWise(true); 

  display.begin(SSD1306_SWITCHCAPVCC, SCREEN_ADDRESS);
  pinMode(2, INPUT);
  display.clearDisplay();
  display.display();
}
int i=5;
void loop() 
{
  homepage(i);
  display.display();
  int z = digitalRead(4);
  int y = digitalRead(3);
  int x = digitalRead(2);

  mysensor.updateMovingAvgExp();
  Serial.print("Angle degree : ");
	Serial.println(mysensor.angleR(U_DEG, false), DEC);
  
  if(x == 1)
  {
    i+=10;
    homepage(i);
  }

  if(y == 1)
  {
    i-=10;
    homepage(i);
  }

  if(z == 1)
  {
    if (i == 5)
    page1();
    if(i == 15)
    page2();
  }
}
void homepage(int i)
{
  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(WHITE);
  display.setCursor(20,5);
  display.print("1.START");
  display.setCursor(20,15);
  display.print("2.STOP");
  display.setCursor(10,i);
  display.print(">");
  display.display();
  delay(3000);

}

void page1()
{
  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(WHITE);
  display.setCursor(20,5);
  display.print("Angle degree: ");
  display.setCursor(20,15);
  display.print(mysensor.angleR(U_DEG, false), DEC);
  display.display();
  delay(8000);
}

void page2()
{
  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(WHITE);
  display.setCursor(20,5);
  display.print("Stopping");
  display.display();
  delay(3000);
}